<html>
    <body>
        <div id="outputDiv"></div>

        <script src="bomText.js"></script>
        <script>
            var rawLines = bybText.split("\n");
            var lineWords = "";
            var previousBookName = "";
            var bookName = "";
            var chapterNum = "";
            var verseNum = "";

            htmlString = "";

            for (var lineNum = 0; lineNum < rawLines.length; lineNum++) {
                lineWords = rawLines[lineNum].split(" ");
                // previousBookName = "not-yet-found";
                // bookName = "not-yet-found";
                chapterNum = "not-yet-found";
                // objectName = "not-yet-foundPP";
                verseNum = "not-yet-found";

                for (var wordNum = 0; wordNum < lineWords.length; wordNum++) {
                    if (lineWords[wordNum].indexOf("|b") !== -1) {
                        bookName = lineWords[wordNum].replaceAll("|b", "").replaceAll("_", "-").toLowerCase();
                        console.log("bookName = " + bookName);
                    }
                    else if (lineWords[wordNum].indexOf("|c") !== -1) {
                        chapterNum = lineWords[wordNum].replaceAll("|c", "").replaceAll("_", "-").toLowerCase();
                        // console.log("   chapterNum = " + chapterNum);
                        objectName = bookName + "-" ;
                        if (parseInt(chapterNum) < 10) {
                            objectName += '0';
                        }
                        objectName += chapterNum;
                        console.log("  objectName = " + objectName);

                        var n = htmlString.lastIndexOf('<br>');
                        htmlString = htmlString.substring(0, n);
                        htmlString += '`,<br>';
                        htmlString += '"' + objectName + '":`';
                        htmlString += 'CHAPTER ' + chapterNum + '<br>';
                    }
                    else if (lineWords[wordNum].indexOf("|v") !== -1) {
                        verseNum = lineWords[wordNum].replaceAll("|v", "").replaceAll("_", "-").toLowerCase();
                        // console.log("      verseNum = " + verseNum);

                        if (verseNum === "0") {
                            for (var i = (wordNum + 1); i < lineWords.length; i++) {
                                htmlString += lineWords[i];
                                if (i < (lineWords.length - 1)) {
                                    htmlString += " ";
                                }
                            }
                            htmlString += "<br>";
                            htmlString += "CHAPTER " + chapterNum + "<br>";
                        }
                        else {
                            htmlString += verseNum + " ";

                            for (var i = (wordNum + 1); i < lineWords.length; i++) {
                                htmlString += lineWords[i];
                                if (i < (lineWords.length - 1)) {
                                    htmlString += " ";
                                }
                            }
                            htmlString += "<br>";
                        }
                    }
                }
            }

            document.getElementById("outputDiv").innerHTML = htmlString;
        </script>
    </body>
</html>